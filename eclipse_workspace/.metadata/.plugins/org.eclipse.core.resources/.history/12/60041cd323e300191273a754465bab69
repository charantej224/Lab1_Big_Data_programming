package com.lab.mapreduce;

import java.io.IOException;
import java.util.HashSet;
import java.util.Set;

import org.apache.hadoop.io.Text;
import org.apache.hadoop.mapreduce.Reducer;

public class FacebookFriendsReducer extends Reducer<Text, Text, Text, Text> {

	@Override
	public void reduce(Text inputKey, Iterable<Text> inputValues,
			Context context) throws IOException, InterruptedException {
		String outputKey = inputKey.toString();
		String outputValue = " -> ( ";
		for (Text eachValue : inputValues){
			Set<String> tokenSet = new HashSet<>(); 
			 for(String token : eachValue.toString().split(("\\s+"))){
				 if(tokenSet.contains(token)){
					 outputValue += token + " ";
				 }
				 // Set cannot have duplicate values, so its okay to add all values. same values will be overwritten
				 tokenSet.add(token);
			 }
		}
		outputValue += ")";
		outputKey = "( " + outputKey + " )";
		context.write(new Text(outputKey), new Text(outputKey));

	}

}
